This is the most important result we have received. The failure of v12.1, even with a numerically superior implicit solver, is a definitive and non-negotiable conclusion:

**The physical model based on a velocity-dependent "Topological Tension" potential is fundamentally flawed and non-conservative.**

The simulation is not wrong; it is correctly showing us that the equations we told it to solve lead to a physical impossibility—a particle that spontaneously generates infinite energy out of nothing. The problem is not with the code, but with the physics itself.

My analysis was incorrect. Adding a potential term `V(j₀)` that depends on the chiral current `j₀` (which itself depends on the field's momentum `π`) created a system where the "force" does positive work on the system, creating a runaway feedback loop. The implicit solver could not fix this because it's a feature of the equations, not a bug in the method.

We must stop trying to patch the second-order Klein-Gordon framework. It is the wrong tool for the job. The repeated failures have pointed us, definitively, in a new direction.

### A New Foundation: The Non-Linear Dirac Equation

The core of CHPT is that particles are *chiral, harmonic knots*. A simple scalar field, even with two components, does not have intrinsic chirality in its kinetic structure. We have been trying to add chirality through force terms, which has failed. The solution is to build chirality into the most fundamental part of the equation: the kinetic term.

The standard, universally accepted equation for fundamental, spinning, chiral particles is the **Dirac equation**. We will now rebuild the entire theory on this foundation.

**I. The New Physical Model (v14)**

1.  **The Fundamental Field:** The field is no longer a two-component scalar `Ψ = {Φ_up, Φ_down}`. It is a four-component **Dirac Spinor**, `ψ`. This is the mathematical object that correctly describes relativistic electrons and quarks. It has four complex components at every point in spacetime.

2.  **The New Lagrangian:** We discard the old Lagrangian entirely. The new Lagrangian is that of a **Non-Linear Dirac Equation**:
    `L = ψ̄(iγµ∂µ - m₀)ψ - U(ψ̄ψ)`

    *   **`ψ̄(iγµ∂µ - m₀)ψ`**: This is the standard, Nobel-prize-winning Dirac kinetic term.
        *   `γµ` are the **gamma matrices**, which are the mathematical engine of spin. They fundamentally mix the spacetime derivatives (`∂µ`) with the spinor's internal components. This term *intrinsically* describes a spinning, chiral object.
        *   `m₀` is the base mass of the particle.
    *   **`- U(ψ̄ψ)`**: This is the new self-interaction potential.
        *   `ψ̄ψ` is the "Dirac bilinear," a scalar quantity that acts like `|Φ|²` did before, representing the field's density.
        *   `U` is a potential function, like `(g/2)(ψ̄ψ)²`, where `g` is a new self-interaction coupling constant. This term provides the non-linear self-interaction that allows solitons to form and provides the short-range repulsion needed for the nuclear force.

3.  **The New Equation of Motion:** Applying the Euler-Lagrange equation to this Lagrangian yields the Non-Linear Dirac Equation:
    ` (iγµ∂µ - m₀)ψ - U'(ψ̄ψ)ψ = 0 `
    Where `U'` is the derivative of the potential `U`. This equation is **first-order in time** (`∂/∂t`), which completely eliminates the unstable `phi`/`pi` dynamic of the previous models.

**II. The New Simulation (v14)**

The simulation must be completely rewritten to solve this first-order equation.

*   **The Solver:** We will again use an **Operator Splitting** method, but a different kind, tailored for the Dirac equation.
    *   **Kinetic Drift:** The `(iγµ∂µ - m₀)ψ` part will be solved exactly in Fourier space. This step is inherently energy-conserving and stable.
    *   **Potential Kick:** The `-U'(ψ̄ψ)ψ` part will be applied as a local "kick" in real space. Since this term does not depend on momentum (`dψ/dt`), the unstable feedback loop that destroyed all previous versions is **gone**.

*   **The Stability Test:** The goal is the same, but the implementation is now based on sound physics. We will initialize a single soliton wave packet and evolve it using the new solver. We will monitor its total probability density, `∫ψ†ψ dV`, which corresponds to the "particle number." For a stable particle, this must remain perfectly constant.

This is not an incremental change. It is a complete overhaul of the theory's mathematical foundation, replacing a flawed model with the correct, established framework for describing chiral particles. This is our best and final chance to find a stable solution.

### CHPT Simulation Framework, Version v14.0

```python
import numpy as np
import matplotlib.pyplot as plt
import time
import os
import sys

# --- Global Settings & Versioning ---
SIMULATION_VERSION = "v14.2"
PLOTTING_ENABLED = True
SCRIPT_FILENAME = f"chpt_simulation_{SIMULATION_VERSION}"
plt.switch_backend('Agg')

# --- Helper Function for Saving Figures ---
def save_figure(case_num_str, suffix=""):
    if PLOTTING_ENABLED:
        filename = f"{SCRIPT_FILENAME}_case_{case_num_str}{suffix}.png"
        try:
            plt.savefig(filename)
            if "step_" not in suffix: print(f"Saved plot to {filename}")
        except Exception as e:
            print(f"Could not save plot: {e}")
        plt.close('all')

# --- Dirac Gamma Matrices (chiral representation) ---
gamma0 = np.array([[0,0,1,0],[0,0,0,1],[1,0,0,0],[0,1,0,0]], dtype=np.complex128)
gamma1 = np.array([[0,0,0,1],[0,0,1,0],[0,-1,0,0],[-1,0,0,0]], dtype=np.complex128)
gamma2 = np.array([[0,0,0,-1j],[0,0,1j,0],[0,1j,0,0],[-1j,0,0,0]], dtype=np.complex128)
gamma3 = np.array([[0,0,1,0],[0,0,0,-1],[-1,0,0,0],[0,1,0,0]], dtype=np.complex128)

# --- The Definitive Stability Test based on the Non-Linear Dirac Equation ---
def run_case_5a_stability_v14():
    """
    Final attempt: Tests stability of a single soliton using the Non-Linear Dirac Equation,
    with a corrected, vectorized, and analytically exact kinetic solver.
    """
    print("\n>>> CASE 5a: STABILITY TEST (v14.2 NON-LINEAR DIRAC SOLVER) <<<")
    print("Desired: The integrated probability density (particle number) must be conserved.")
    
    # Simulation Parameters
    N=64; dx=0.5; dt=0.02; T_steps=5000
    m0 = 1.0  # Base mass
    g = 2.0   # Self-interaction strength
    
    # --- Field Initialization ---
    psi = np.zeros((4, N, N, N), dtype=np.complex128)
    X,Y,Z = np.mgrid[-N//2:N//2,-N//2:N//2,-N//2:N//2]*dx
    R = np.sqrt(X**2 + Y**2 + Z**2)
    profile = np.exp(-R**2 / 2.5**2)
    psi[0, ...] = profile; psi[1, ...] = profile
    
    # --- Setup for Fourier Space ---
    kx=2*np.pi*np.fft.fftfreq(N,d=dx);ky=2*np.pi*np.fft.fftfreq(N,d=dx);kz=2*np.pi*np.fft.fftfreq(N,d=dx)
    KX, KY, KZ = np.meshgrid(kx, ky, kz, indexing='ij')

    alpha1 = gamma1 @ gamma0; alpha2 = gamma2 @ gamma0; alpha3 = gamma3 @ gamma0
    H_k_5D = alpha1[:,:,None,None,None]*KX + alpha2[:,:,None,None,None]*KY + alpha3[:,:,None,None,None]*KZ + m0*gamma0[:,:,None,None,None]
    
    E_k = np.sqrt(KX**2 + KY**2 + KZ**2 + m0**2)
    cos_E_dt = np.cos(E_k * dt); sin_E_dt_over_E = np.sin(E_k * dt) / (E_k + 1e-9)
    identity_5D = np.identity(4)[:,:,None,None,None]
    U_kinetic = cos_E_dt * identity_5D - 1j * sin_E_dt_over_E * H_k_5D

    # --- Diagnostics ---
    particle_number = []
    initial_number = np.sum(np.conj(psi) * psi)
    print("Running stability simulation with Non-Linear Dirac solver...")
    
    for t in range(T_steps):
        # --- Operator Splitting ---
        # POTENTIAL KICK (dt/2)
        # --- FIX: Use np.einsum for correct matrix multiplication ---
        gamma0_psi = np.einsum('ab,b...->a...', gamma0, psi)
        psi_bar_psi = np.sum(np.conj(psi) * gamma0_psi, axis=0)
        # --- END FIX ---
        
        potential_term = g * psi_bar_psi
        U_potential = np.exp(-1j * potential_term * (dt / 2.0))
        psi *= U_potential
        
        # KINETIC DRIFT (dt)
        psi_k = np.fft.fftn(psi, axes=(1,2,3))
        psi_k = np.einsum('ab...,b...->a...', U_kinetic, psi_k)
        psi = np.fft.ifftn(psi_k, axes=(1,2,3))
        
        # SECOND POTENTIAL KICK (dt/2)
        # --- FIX: Use np.einsum for correct matrix multiplication ---
        gamma0_psi = np.einsum('ab,b...->a...', gamma0, psi)
        psi_bar_psi = np.sum(np.conj(psi) * gamma0_psi, axis=0)
        # --- END FIX ---
        
        potential_term = g * psi_bar_psi
        U_potential = np.exp(-1j * potential_term * (dt / 2.0))
        psi *= U_potential

        if t % 200 == 0:
            current_number = np.sum(np.conj(psi) * psi)
            particle_number.append(current_number)
            print(f"Step {t}/{T_steps}, Particle Number: {current_number.real:.6f}")

    particle_number = np.array(particle_number)
    final_number = particle_number[-1]
    number_change_percent = np.abs(final_number - initial_number) / initial_number * 100

    print(f"Observed: Particle number changed by {number_change_percent.real:.6f}% over {T_steps} steps.")
    print("\n--- VERIFICATION ---")
    if number_change_percent < 0.01 and np.isfinite(final_number):
        print("SUCCESS: Single Dirac soliton is STABLE. This physical model is valid.")
    else:
        print("FAILURE: The Non-Linear Dirac model, or its simulation, is still unstable.")

    if PLOTTING_ENABLED:
        plt.figure(figsize=(10, 6))
        plt.plot(np.linspace(0, T_steps, len(particle_number)), particle_number.real)
        plt.title("Case 5a: Particle Number Conservation (v14.2 Dirac Solver)")
        plt.xlabel("Time Step"); plt.ylabel("Total Probability (Particle Number)")
        plt.grid(True);
        if particle_number.size > 0 and np.all(np.isfinite(particle_number)):
             # Set tight y-limits to see small fluctuations
             plt.ylim(particle_number.real.min() * 0.9999, particle_number.real.max() * 1.0001)
        save_figure("5a_stability")

# --- Main Execution ---
if __name__ == "__main__":
    start_time = time.time()
    run_case_5a_stability_v14()
    end_time = time.time()
    print(f"\nTotal execution time: {end_time - start_time:.2f} seconds.")

```
